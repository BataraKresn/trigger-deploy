<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ” Services Monitor - Trigger Deploy</title>
  <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
  <link rel="stylesheet" href="/static/styles.css">
  <style>
    .service-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }
    
    .service-card {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      border-left: 4px solid #666;
    }
    
    .service-card.healthy {
      border-left-color: #28a745;
    }
    
    .service-card.unhealthy {
      border-left-color: #dc3545;
    }
    
    .service-card.critical {
      border: 2px solid #dc3545;
      background: #fff5f5;
    }
    
    .service-header {
      display: flex;
      justify-content: between;
      align-items: center;
      margin-bottom: 1rem;
    }
    
    .service-status {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .status-healthy {
      background: #d4edda;
      color: #155724;
    }
    
    .status-unhealthy {
      background: #f8d7da;
      color: #721c24;
    }
    
    .status-unknown {
      background: #f8f9fa;
      color: #6c757d;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ” Services Monitor</h1>
      <p>Real-time monitoring of Docker containers and remote services</p>
    </div>
    
    <div class="content">
      <!-- Navigation & Controls -->
      <div class="controls">
        <a href="/" class="btn btn-secondary">â† Back to Home</a>
        <button onclick="refreshServices()" class="btn btn-primary" id="refreshBtn">
          ğŸ”„ Refresh Status
        </button>
        <button onclick="toggleMonitoring()" class="btn btn-warning" id="toggleBtn">
          â¸ï¸ Pause Monitoring
        </button>
        <button onclick="showConfig()" class="btn btn-info">
          âš™ï¸ Configure Services
        </button>
      </div>

      <!-- Status Information -->
      <div class="status-info">
        <div class="last-update-section">
          <h4>ğŸ“Š System Status</h4>
          <div id="lastUpdate" class="status-text">
            Last updated: Never
          </div>
          <div class="status-details">
            <div class="status-item">
              <span class="status-label">Monitor Status:</span>
              <span id="monitorStatus" class="status-value">Active</span>
            </div>
            <div class="status-item">
              <span class="status-label">Check Interval:</span>
              <span id="checkInterval" class="status-value">Loading...</span>
            </div>
            <div class="status-item">
              <span class="status-label">Next Check:</span>
              <span id="nextCheck" class="status-value">In 45 seconds</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Summary Cards -->
      <div class="summary-cards">
        <div class="summary-card">
          <div class="summary-value text-info" id="totalServices">-</div>
          <div>Total Services</div>
        </div>
        <div class="summary-card">
          <div class="summary-value text-success" id="healthyServices">-</div>
          <div>Healthy</div>
        </div>
        <div class="summary-card">
          <div class="summary-value text-danger" id="unhealthyServices">-</div>
          <div>Unhealthy</div>
        </div>
        <div class="summary-card">
          <div class="summary-value text-warning" id="criticalDown">-</div>
          <div>Critical Down</div>
        </div>
      </div>

      <!-- Local Services -->
      <div class="chart-container">
        <h3>ğŸ³ Local Docker Services</h3>
        <div id="localServices" class="service-grid">
          <!-- Services will be loaded here -->
        </div>
      </div>

      <!-- Remote Services -->
      <div class="chart-container">
        <h3>ğŸŒ Remote Services</h3>
        <div id="remoteServices" class="service-grid">
          <!-- Services will be loaded here -->
        </div>
      </div>

      <!-- Alerts History -->
      <div class="chart-container">
        <h3>ğŸš¨ Recent Alerts</h3>
        <div id="alertsHistory">
          <div class="alert alert-info">
            ğŸ“ No recent alerts. All services are running smoothly.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Configuration Modal -->
  <div id="configModal" class="modal">
    <div class="modal-content">
      <h2>âš™ï¸ Services Configuration</h2>
      <p class="text-muted mb-3">Configure which services to monitor</p>
      
      <div class="form-group">
        <label for="configJson">Configuration JSON:</label>
        <textarea id="configJson" class="form-control" placeholder="Loading configuration..."></textarea>
      </div>
      
      <div class="buttons">
        <button type="button" onclick="closeConfigModal()" class="btn btn-secondary">
          Cancel
        </button>
        <button type="button" onclick="saveConfig()" class="btn btn-primary">
          ğŸ’¾ Save Configuration
        </button>
      </div>
    </div>
  </div>

  <!-- Global Loading Overlay -->
  <div id="spinner" class="spinner-overlay hidden">
    <div class="spinner-content">
      <div class="spinner"></div>
      <p class="spinner-text">ğŸ” Checking services...</p>
    </div>
  </div>

  <script src="/static/services-monitor.js"></script>
</body>
</html>
